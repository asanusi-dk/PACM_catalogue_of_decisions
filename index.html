<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Paris Agreement Crediting Mechanism Catalogue of Documents</title>

  <!-- Base site styles (your existing file) -->
  <link rel="stylesheet" href="assets/style.css?v=8">
  <!-- Grouped-table styles (new) -->
  <link rel="stylesheet" href="assets/styles.css?v=pkg2">
</head>
<body>
  <header class="appbar">
    <div class="appbar-inner">
      <div class="brand">
        <div class="brand-text">
          <h1>Paris Agreement Crediting Mechanism Catalogue of Documents</h1>
          <p class="tagline">Search document and texts related to PACM</p>
        </div>
      </div>
    </div>

    <div class="controls">
      <input id="q" type="search" placeholder='Search… tip: use quotes for exact phrases, e.g. "reversal buffer"'>
      <label class="toggle">
        <input id="fulltextToggle" type="checkbox">
        <span>Full-text</span>
      </label>
      <div class="view-toggle" role="tablist" aria-label="Result view">
        <label class="tab"><input type="radio" name="view" value="docs" checked> Documents</label>
        <label class="tab"><input type="radio" name="view" value="hits"> Matches</label>
      </div>
      <button id="reset" class="ghost">Reset</button>
    </div>

    <!-- Status banner controlled by assets/app.js -->
    <div id="doc-status" class="status warn" role="status" aria-live="polite">Loading…</div>
  </header>

  <main>
    <!-- Catalogue table START -->
    <table id="doc-table" class="doc-table" style="width:100%; border-collapse:collapse">
      <!-- Headers are injected by assets/app.js based on its HEADERS array -->
      <thead></thead>
      <tbody id="doc-tbody"></tbody>
    </table>
    <!-- Catalogue table END -->

    <!-- Existing panels for the Matches view (full-text) -->
    <div id="count" class="count"></div>
    <div id="list"></div>
    <div id="hitsHeader" class="count hidden"></div>
    <div id="hits" class="hitlist hidden" tabindex="0" aria-label="Flat matches list (use ↑/↓ or j/k)"></div>
  </main>

  <footer>
    <p>Source: UNFCCC A6.4 Supervisory Body – Rules & Regulations. Links point to official PDFs.</p>
  </footer>

  <!-- Scripts -->
  <!-- Your existing full-text logic; keep this if you use the Matches view -->
  <script src="assets/fulltext.js?v=8"></script>

  <!-- Toggle between Documents (table) and Matches (full-text hits) -->
  <script>
  (function(){
    const docsTable = document.getElementById('doc-table');
    const hitsPanel = document.getElementById('hits');
    const hitsHeader = document.getElementById('hitsHeader');
    const radios = document.querySelectorAll('input[name="view"]');
    const resetBtn = document.getElementById('reset');
    const q = document.getElementById('q');

    function pick(v){
      const showDocs = v === 'docs';
      if (docsTable) docsTable.style.display = showDocs ? '' : 'none';
      if (hitsPanel) hitsPanel.classList.toggle('hidden', showDocs);
      if (hitsHeader) hitsHeader.classList.toggle('hidden', showDocs);
    }
    radios.forEach(r => r.addEventListener('change', e => pick(e.target.value)));
    const current = document.querySelector('input[name="view"]:checked');
    pick(current ? current.value : 'docs');

    // Reset = clear search + go back to Docs
    if (resetBtn){
      resetBtn.addEventListener('click', () => {
        if(q){ q.value = ''; q.dispatchEvent(new Event('input')); }
        const docsTab = document.querySelector('input[name="view"][value="docs"]');
        if (docsTab){ docsTab.checked = true; docsTab.dispatchEvent(new Event('change')); }
      });
    }
  })();
  </script>

  <!-- Grouped-table renderer (new). ONLY this app.js should be included. -->
  <script src="assets/app.js?v=pkg2"></script>
</body>
</html>
